(this.webpackJsonpsnake=this.webpackJsonpsnake||[]).push([[0],{14:function(e,t,i){e.exports=i(30)},19:function(e,t,i){},29:function(e,t,i){},30:function(e,t,i){"use strict";i.r(t);var a=i(0),r=i.n(a),s=i(13),n=i.n(s),o=(i(19),i(1)),l=i(2),c=i(5),h=i(4),p=i(3),u=function(e){Object(c.a)(i,e);var t=Object(h.a)(i);function i(e){var a;Object(o.a)(this,i),(a=t.call(this,e)).canvas=null,a.scaling=10,a.frameCount=0;for(var r=[],s=0;s<e.ySize;s++)for(var n=0;n<e.xSize;n++)r[s]||(r[s]=[]),r[s][n]=0;return a.display=r,a.colorStore={1:"#444"},a}return Object(l.a)(i,[{key:"data",value:function(){return{display:null}}},{key:"regColor",value:function(e,t){this.colorStore[e]=t}},{key:"onFrame",value:function(){var e=this;this.props.onFrame&&this.props.onFrame(this.frameCount++),requestAnimationFrame((function(){e.onFrame()}));var t=[];for(var i in this.display)for(var a in this.display[i])0==this.display[i][a]?(this.ctx.fillStyle="#fff",this.ctx.fillRect(a*this.scaling,i*this.scaling,this.scaling,this.scaling),this.ctx.strokeStyle="#eee",this.ctx.strokeRect(a*this.scaling,i*this.scaling,this.scaling,this.scaling)):t.push({x:a,y:i});t.forEach((function(t){var i=e.display[t.y][t.x],a=e.colorStore[i];if("object"==typeof a&&"IMG"==a.tagName){var r=t.x*e.scaling,s=t.y*e.scaling;r-=a.width/2,s-=a.height/2,e.ctx.drawImage(a,0,0,a.naturalWidth,a.naturalHeight,r,s,a.width,a.height)}else a&&(e.ctx.fillStyle=a,e.ctx.fillRect(t.x*e.scaling,t.y*e.scaling,e.scaling,e.scaling))}))}},{key:"componentDidMount",value:function(){var e=this;this.ctx=this.canvas.getContext("2d"),requestAnimationFrame((function(){e.onFrame()}))}},{key:"setBlock",value:function(e,t,i){this.display[t][e]=i||1}},{key:"delBlock",value:function(e,t){this.display[t][e]=0}},{key:"clearAll",value:function(){this.frameCount=0;for(var e=[],t=0;t<this.props.ySize;t++)for(var i=0;i<this.props.xSize;i++)e[t]||(e[t]=[]),e[t][i]=0;this.display=e}},{key:"render",value:function(){var e=this;return r.a.createElement("div",Object.assign({style:{width:"100%"}},this.props),r.a.createElement("canvas",{ref:function(t){e.canvas=t},width:this.props.xSize*this.scaling,height:this.props.ySize*this.scaling,style:{border:"1px solid #000"}}))}}]),i}(p.BlazeComponent),d=function(e){Object(c.a)(i,e);var t=Object(h.a)(i);function i(e){var a;return Object(o.a)(this,i),(a=t.call(this,e)).player1={direction:"right",nextDirection:"",score:0,footprint:[],snakes:[]},a.player2={direction:"right",nextDirection:"",score:0,footprint:[],snakes:[]},a.bugPosition=[-1,-1],a.xSize=40,a.ySize=30,a.nextDirection="",a}return Object(l.a)(i,[{key:"data",value:function(){return{skipFrames:5,running:!1,tips:"Press Button TO Start!",imgMode:!1}}},{key:"getRandom",value:function(e,t){return parseInt(Math.random()*(t-e+1)+e)}},{key:"getNewBugs",value:function(){var e=this.getRandom(0,this.xSize-1),t=this.getRandom(0,this.ySize-1);for(var i in this.snakes){var a=this.snakes[i];if(e==a[0]&&t==a[1])return this.getNewBugs()}return[e,t]}},{key:"componentDidMount",value:function(){var e=this;window.addEventListener("keypress",(function(t){switch(t.key){case"w":case"W":"down"!=e.player1.direction&&(e.player1.nextDirection="up");break;case"a":case"A":"right"!=e.player1.direction&&(e.player1.nextDirection="left");break;case"s":case"S":"up"!=e.player1.direction&&(e.player1.nextDirection="down");break;case"d":case"D":"left"!=e.player1.direction&&(e.player1.nextDirection="right");break;case"i":case"I":"down"!=e.player2.direction&&(e.player2.nextDirection="up");break;case"j":case"J":"right"!=e.player2.direction&&(e.player2.nextDirection="left");break;case"k":case"K":"up"!=e.player2.direction&&(e.player2.nextDirection="down");break;case"l":case"L":"left"!=e.player2.direction&&(e.player2.nextDirection="right")}})),this.drawer.regColor(2,"#f44"),this.drawer.regColor(21,"#fee"),this.drawer.regColor(3,"#44f"),this.drawer.regColor(31,"#eef");var t=new Image(120,120);t.src="https://kagamine.cn/snake/k/right.png",this.drawer.regColor(25,t);var i=new Image(120,120);i.src="https://kagamine.cn/snake/k/left.png",this.drawer.regColor(26,i),(t=new Image(120,120)).src="https://kagamine.cn/snake/k/right2.png",this.drawer.regColor(35,t),(i=new Image(120,120)).src="https://kagamine.cn/snake/k/left2.png",this.drawer.regColor(36,i)}},{key:"checkGameover",value:function(e,t){if(e[0]<0||e[0]>=this.xSize||e[1]<0||e[1]>=this.ySize)return!0;for(var i in this.player1.snakes){var a=this.player1.snakes[i];if(e[0]==a[0]&&e[1]==a[1])return!0}for(var r in this.player2.snakes){var s=this.player2.snakes[r];if(e[0]==s[0]&&e[1]==s[1])return!0}return!1}},{key:"onFrame",value:function(e){var t=this;if(this.$data.running&&e%(1+this.$data.skipFrames)==0){-1==this.bugPosition[0]&&(this.score=0,this.bugPosition=this.getNewBugs(),this.player1.snakes=[],this.player1.footprint=[],this.player1.score=0,this.player1.nextDirection="",this.player1.direction="right",this.player1.snakes.push([5,5]),this.player1.snakes.push([4,5]),this.player2.snakes=[],this.player2.footprint=[],this.player2.score=0,this.player2.nextDirection="",this.player2.direction&&(this.player2.direction="right",this.player2.snakes.push([5,10]),this.player2.snakes.push([4,10]))),this.player1.nextDirection&&(this.player1.direction=this.player1.nextDirection),this.player2.nextDirection&&(this.player2.direction=this.player2.nextDirection);var i=[];switch(this.player1.direction){case"left":i=[this.player1.snakes[0][0]-1,this.player1.snakes[0][1]];break;case"right":i=[this.player1.snakes[0][0]+1,this.player1.snakes[0][1]];break;case"up":i=[this.player1.snakes[0][0],this.player1.snakes[0][1]-1];break;case"down":i=[this.player1.snakes[0][0],this.player1.snakes[0][1]+1]}if(this.checkGameover(i))return this.$data.running=!1,this.bugPosition=[-1,-1],this.drawer.clearAll(),void(this.$data.tips="2P WIN!");if(this.player1.snakes.unshift(i),i[0]==this.bugPosition[0]&&i[1]==this.bugPosition[1])this.bugPosition=this.getNewBugs(),this.player1.score+=1;else{var a=this.player1.snakes.pop();this.player1.footprint.push({addFrame:e,x:a[0],y:a[1]}),this.drawer.delBlock(a[0],a[1])}var r=[];if(this.player2.direction){switch(this.player2.direction){case"left":r=[this.player2.snakes[0][0]-1,this.player2.snakes[0][1]];break;case"right":r=[this.player2.snakes[0][0]+1,this.player2.snakes[0][1]];break;case"up":r=[this.player2.snakes[0][0],this.player2.snakes[0][1]-1];break;case"down":r=[this.player2.snakes[0][0],this.player2.snakes[0][1]+1]}if(this.checkGameover(r))return this.$data.running=!1,this.bugPosition=[-1,-1],this.drawer.clearAll(),void(this.$data.tips="1P WIN!");if(this.player2.snakes.unshift(r),r[0]==this.bugPosition[0]&&r[1]==this.bugPosition[1])this.bugPosition=this.getNewBugs(),this.player2.score+=1;else{a=this.player2.snakes.pop();this.player2.footprint.push({addFrame:e,x:a[0],y:a[1]}),this.drawer.delBlock(a[0],a[1])}}this.player1.footprint.forEach((function(i){e-i.addFrame>500?t.drawer.delBlock(i.x,i.y):t.drawer.setBlock(i.x,i.y,21)})),this.player2.footprint.forEach((function(i){e-i.addFrame>500?t.drawer.delBlock(i.x,i.y):t.drawer.setBlock(i.x,i.y,31)})),this.player1.snakes.forEach((function(e,i){0==i?t.$data.imgMode?"left"==t.player1.direction?t.drawer.setBlock(e[0],e[1],26):t.drawer.setBlock(e[0],e[1],25):t.drawer.setBlock(e[0],e[1],2):t.drawer.setBlock(e[0],e[1])})),this.player2.snakes.forEach((function(e,i){0==i?t.$data.imgMode?"left"==t.player2.direction?t.drawer.setBlock(e[0],e[1],36):t.drawer.setBlock(e[0],e[1],35):t.drawer.setBlock(e[0],e[1],3):t.drawer.setBlock(e[0],e[1])})),this.drawer.setBlock(this.bugPosition[0],this.bugPosition[1]),this.$data.tips="Score1:"+this.player1.score+" Score2:"+this.player2.score}}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{style:{width:"100%",margin:"auto",textAlign:"center"}},r.a.createElement("h1",null,"Snake Game"),r.a.createElement("div",null,"by LenShang"),r.a.createElement("div",null,"git:",r.a.createElement("a",{href:"https://github.com/Lenshang/js-snake",target:"blank"},"https://github.com/Lenshang/js-snake")),r.a.createElement("div",{style:{marginTop:10}},this.$data.tips),this.$data.running?null:r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){e.$data.running=!0,e.player2.direction=""}},"start 1p"),r.a.createElement("button",{onClick:function(){e.$data.running=!0,e.player2.direction="right"}},"start 2p")),r.a.createElement("a",{style:{fontSize:5,color:"#cccccc"},href:"javascript:void(0)",onClick:function(){e.$data.imgMode=!e.$data.imgMode}},"dont Click me"),r.a.createElement(u,{onFrame:function(t){e.onFrame(t)},style:{marginTop:20},ref:function(t){e.drawer=t},xSize:this.xSize,ySize:this.ySize}))}}]),i}(p.BlazeComponent);i(29);var y=function(){return r.a.createElement("div",{style:{width:"100%"}},r.a.createElement(d,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(y,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[14,1,2]]]);
//# sourceMappingURL=main.f9e5c065.chunk.js.map